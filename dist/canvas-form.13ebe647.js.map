{"version":3,"sources":["js/canvas-form.js"],"names":["canvas","document","querySelector","context","getContext","width","height","dpr","currentFocus","RADIUS","TAIL_LENGTH","head","tail","resize","window","devicePixelRatio","innerWidth","innerHeight","scale","redraw","paint","requestAnimationFrame","clearRect","push","length","shift","beginPath","moveTo","x","y","i","p1","p2","quadraticCurveTo","lineWidth","lineCap","strokeStyle","stroke","tx","ty","vx","arc","Math","PI","fillStyle","fill","focus","element","previousFocus","offsetLeft","offsetTop","offsetHeight","abs","body","addEventListener","event","target"],"mappings":";AAAA,MAAMA,EAASC,SAASC,cAAc,WAChCC,EAAUH,EAAOI,WAAW,MAElC,IAAIC,EAAOC,EAAQC,EACfC,EAEJ,MAAMC,EAAS,EACTC,EAAc,GAEdC,EAAO,GACPC,EAAO,GAIb,SAASC,IACLN,EAAMO,OAAOC,kBAAoB,EAEjCV,EAAQS,OAAOE,WACfV,EAASQ,OAAOG,YAEhBjB,EAAOK,MAAQA,EAAQE,EACvBP,EAAOM,OAASA,EAASC,EAEzBJ,EAAQe,MAAMX,EAAKA,GAGvB,SAASY,IACLC,IAEAC,sBAAsBF,GAG1B,SAASC,IAGDZ,GAFJL,EAAQmB,UAAU,EAAG,EAAGjB,EAAOC,GAE3BE,EAAc,CAMVI,GAJJA,EAAKW,KAAK,IAAIZ,IACVC,EAAKY,OAASd,GAAaE,EAAKa,QAGhCb,EAAKY,OAAS,EAAG,CACjBrB,EAAQuB,YACRvB,EAAQwB,OAAOf,EAAK,GAAGgB,EAAGhB,EAAK,GAAGiB,GAE7B,IAAA,IAAIC,EAAI,EAAGA,EAAIlB,EAAKY,OAAS,EAAGM,IAAK,CAChCC,MAAAA,EAAKnB,EAAKkB,GACVE,EAAKpB,EAAKkB,EAAI,GAEpB3B,EAAQ8B,iBAAiBF,EAAGH,EAAGG,EAAGF,GAAIE,EAAGH,EAAII,EAAGJ,GAAK,GAAIG,EAAGF,EAAIG,EAAGH,GAAK,GAG5E1B,EAAQ8B,iBAAiBrB,EAAKkB,GAAGF,EAAGhB,EAAKkB,GAAGD,EAAGjB,EAAKkB,EAAI,GAAGF,EAAGhB,EAAKkB,EAAI,GAAGD,GAE1E1B,EAAQ+B,UAAYzB,EACpBN,EAAQgC,QAAU,QAClBhC,EAAQiC,YAAc,OACtBjC,EAAQkC,SAIZ1B,EAAKiB,GAA0B,IAApBjB,EAAK2B,GAAK3B,EAAKiB,GAC1BjB,EAAKkB,GAA0B,IAApBlB,EAAK4B,GAAK5B,EAAKkB,GAE1BlB,EAAK6B,IAAM,GACX7B,EAAKiB,GAAKjB,EAAK6B,GAEfrC,EAAQuB,YACRvB,EAAQsC,IAAI9B,EAAKiB,EAAGjB,EAAKkB,EAAGpB,EAAQ,EAAa,EAAViC,KAAKC,IAC5CxC,EAAQyC,UAAY,UACpBzC,EAAQ0C,QAIhB,SAASC,EAAMC,GACLC,MAAAA,EAAgBxC,EAElBuC,IAASvC,EAAeuC,GAEvBvC,IAELG,EAAK2B,GAAK9B,EAAayC,WAAa,GAAKxC,EACzCE,EAAK4B,GAAK/B,EAAa0C,UAAY1C,EAAa2C,aAAe,EAEzC,iBAAXxC,EAAKiB,IACZjB,EAAKiB,EAAIjB,EAAK2B,GACd3B,EAAKkB,EAAIlB,EAAK4B,IAGd/B,IAAiBwC,IACjBrC,EAAK6B,IAAM,EAAIE,KAAKU,IAAIzC,EAAK2B,GAAK3B,EAAKiB,GAAK,IA9EpD3B,SAASoD,KAAKC,iBAAiB,QAASC,GAAST,EAAMS,EAAMC,SAAS,GAkFtE3C,IACAM,IAEAL,OAAOwC,iBAAiB,SAAU,KAC9BjC,sBAAsB,KAClBR,IACAiC,IACA1B,QAIRN,OAAOwC,iBAAiB,SAAU,KAC9BjC,sBAAsB,KAClByB,IACA1B","file":"canvas-form.13ebe647.js","sourceRoot":"..\\src","sourcesContent":["const canvas = document.querySelector('.canvas');\r\nconst context = canvas.getContext('2d');\r\n\r\nlet width, height, dpr;\r\nlet currentFocus;\r\n\r\nconst RADIUS = 8;\r\nconst TAIL_LENGTH = 10;\r\n\r\nconst head = {};\r\nconst tail = [];\r\n\r\ndocument.body.addEventListener('focus', event => focus(event.target), true);\r\n\r\nfunction resize() {\r\n    dpr = window.devicePixelRatio || 1;\r\n\r\n    width = window.innerWidth;\r\n    height = window.innerHeight;\r\n\r\n    canvas.width = width * dpr;\r\n    canvas.height = height * dpr;\r\n\r\n    context.scale(dpr, dpr);\r\n}\r\n\r\nfunction redraw() {\r\n    paint();\r\n\r\n    requestAnimationFrame(redraw);\r\n}\r\n\r\nfunction paint() {\r\n    context.clearRect(0, 0, width, height);\r\n\r\n    if (currentFocus) {\r\n        // Add to the tail\r\n        tail.push({...head });\r\n        if (tail.length > TAIL_LENGTH) tail.shift();\r\n\r\n        // Paint the tail\r\n        if (tail.length > 3) {\r\n            context.beginPath();\r\n            context.moveTo(tail[0].x, tail[0].y);\r\n\r\n            for (var i = 2; i < tail.length - 2; i++) {\r\n                const p1 = tail[i];\r\n                const p2 = tail[i + 1];\r\n\r\n                context.quadraticCurveTo(p1.x, p1.y, (p1.x + p2.x) / 2, (p1.y + p2.y) / 2);\r\n            }\r\n\r\n            context.quadraticCurveTo(tail[i].x, tail[i].y, tail[i + 1].x, tail[i + 1].y);\r\n\r\n            context.lineWidth = RADIUS;\r\n            context.lineCap = 'round';\r\n            context.strokeStyle = '#fff';\r\n            context.stroke();\r\n        }\r\n\r\n        // Animate the head towards target x/y\r\n        head.x += (head.tx - head.x) * 0.2;\r\n        head.y += (head.ty - head.y) * 0.2;\r\n\r\n        head.vx *= 0.8;\r\n        head.x += head.vx;\r\n\r\n        context.beginPath();\r\n        context.arc(head.x, head.y, RADIUS, 0, Math.PI * 2);\r\n        context.fillStyle = '#6a6376';\r\n        context.fill();\r\n    }\r\n}\r\n\r\nfunction focus(element) {\r\n    const previousFocus = currentFocus;\r\n\r\n    if (element) currentFocus = element;\r\n\r\n    if (!currentFocus) return;\r\n\r\n    head.tx = currentFocus.offsetLeft - 12 - RADIUS;\r\n    head.ty = currentFocus.offsetTop + currentFocus.offsetHeight / 2;\r\n\r\n    if (typeof head.x !== 'number') {\r\n        head.x = head.tx;\r\n        head.y = head.ty;\r\n    }\r\n\r\n    if (currentFocus !== previousFocus) {\r\n        head.vx = -8 - Math.abs(head.tx - head.x) / 5;\r\n    }\r\n}\r\n\r\nresize();\r\nredraw();\r\n\r\nwindow.addEventListener('resize', () => {\r\n    requestAnimationFrame(() => {\r\n        resize();\r\n        focus();\r\n        paint();\r\n    });\r\n});\r\n\r\nwindow.addEventListener('scroll', () => {\r\n    requestAnimationFrame(() => {\r\n        focus();\r\n        paint();\r\n    });\r\n});\r\n\r\n// document.querySelectorAll('input')[0].focus();"]}