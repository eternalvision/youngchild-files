{"version":3,"sources":["js/canvas-form.js"],"names":["canvas","document","querySelector","context","getContext","width","height","dpr","currentFocus","RADIUS","TAIL_LENGTH","head","tail","resize","window","devicePixelRatio","innerWidth","innerHeight","scale","redraw","paint","requestAnimationFrame","clearRect","push","length","shift","beginPath","moveTo","x","y","i","p1","p2","quadraticCurveTo","lineWidth","lineCap","strokeStyle","stroke","tx","ty","vx","arc","Math","PI","fillStyle","fill","focus","element","previousFocus","offsetLeft","offsetTop","offsetHeight","abs","body","addEventListener","event","target"],"mappings":";AAAA,MAAMA,EAASC,SAASC,cAAc,WAChCC,EAAUH,EAAOI,WAAW,MAElC,IAAIC,EAAOC,EAAQC,EACfC,EAEJ,MAAMC,EAAS,EACTC,EAAc,GAEdC,EAAO,GACPC,EAAO,GAIb,SAASC,IACLN,EAAMO,OAAOC,kBAAoB,EAEjCV,EAAQS,OAAOE,WACfV,EAASQ,OAAOG,YAEhBjB,EAAOK,MAAQA,EAAQE,EACvBP,EAAOM,OAASA,EAASC,EAEzBJ,EAAQe,MAAMX,EAAKA,GAGvB,SAASY,IACLC,IAEAC,sBAAsBF,GAG1B,SAASC,IAGDZ,GAFJL,EAAQmB,UAAU,EAAG,EAAGjB,EAAOC,GAE3BE,EAAc,CAMVI,GAJJA,EAAKW,KAAK,IAAIZ,IACVC,EAAKY,OAASd,GAAaE,EAAKa,QAGhCb,EAAKY,OAAS,EAAG,CACjBrB,EAAQuB,YACRvB,EAAQwB,OAAOf,EAAK,GAAGgB,EAAGhB,EAAK,GAAGiB,GAE7B,IAAA,IAAIC,EAAI,EAAGA,EAAIlB,EAAKY,OAAS,EAAGM,IAAK,CAChCC,MAAAA,EAAKnB,EAAKkB,GACVE,EAAKpB,EAAKkB,EAAI,GAEpB3B,EAAQ8B,iBAAiBF,EAAGH,EAAGG,EAAGF,GAAIE,EAAGH,EAAII,EAAGJ,GAAK,GAAIG,EAAGF,EAAIG,EAAGH,GAAK,GAG5E1B,EAAQ8B,iBAAiBrB,EAAKkB,GAAGF,EAAGhB,EAAKkB,GAAGD,EAAGjB,EAAKkB,EAAI,GAAGF,EAAGhB,EAAKkB,EAAI,GAAGD,GAE1E1B,EAAQ+B,UAAYzB,EACpBN,EAAQgC,QAAU,QAClBhC,EAAQiC,YAAc,OACtBjC,EAAQkC,SAIZ1B,EAAKiB,GAA0B,IAApBjB,EAAK2B,GAAK3B,EAAKiB,GAC1BjB,EAAKkB,GAA0B,IAApBlB,EAAK4B,GAAK5B,EAAKkB,GAE1BlB,EAAK6B,IAAM,GACX7B,EAAKiB,GAAKjB,EAAK6B,GAEfrC,EAAQuB,YACRvB,EAAQsC,IAAI9B,EAAKiB,EAAGjB,EAAKkB,EAAGpB,EAAQ,EAAa,EAAViC,KAAKC,IAC5CxC,EAAQyC,UAAY,UACpBzC,EAAQ0C,QAIhB,SAASC,EAAMC,GACLC,MAAAA,EAAgBxC,EAElBuC,IAASvC,EAAeuC,GAEvBvC,IAELG,EAAK2B,GAAK9B,EAAayC,WAAa,GAAKxC,EACzCE,EAAK4B,GAAK/B,EAAa0C,UAAY1C,EAAa2C,aAAe,EAEzC,iBAAXxC,EAAKiB,IACZjB,EAAKiB,EAAIjB,EAAK2B,GACd3B,EAAKkB,EAAIlB,EAAK4B,IAGd/B,IAAiBwC,IACjBrC,EAAK6B,IAAM,EAAIE,KAAKU,IAAIzC,EAAK2B,GAAK3B,EAAKiB,GAAK,IA9EpD3B,SAASoD,KAAKC,iBAAiB,QAASC,GAAST,EAAMS,EAAMC,SAAS,GAkFtE3C,IACAM,IAEAL,OAAOwC,iBAAiB,SAAU,KAC9BjC,sBAAsB,KAClBR,IACAiC,IACA1B,QAIRN,OAAOwC,iBAAiB,SAAU,KAC9BjC,sBAAsB,KAClByB,IACA1B","file":"canvas-form.a93d17d7.js","sourceRoot":"../src","sourcesContent":["const canvas = document.querySelector('.canvas');\nconst context = canvas.getContext('2d');\n\nlet width, height, dpr;\nlet currentFocus;\n\nconst RADIUS = 8;\nconst TAIL_LENGTH = 10;\n\nconst head = {};\nconst tail = [];\n\ndocument.body.addEventListener('focus', event => focus(event.target), true);\n\nfunction resize() {\n    dpr = window.devicePixelRatio || 1;\n\n    width = window.innerWidth;\n    height = window.innerHeight;\n\n    canvas.width = width * dpr;\n    canvas.height = height * dpr;\n\n    context.scale(dpr, dpr);\n}\n\nfunction redraw() {\n    paint();\n\n    requestAnimationFrame(redraw);\n}\n\nfunction paint() {\n    context.clearRect(0, 0, width, height);\n\n    if (currentFocus) {\n        // Add to the tail\n        tail.push({...head });\n        if (tail.length > TAIL_LENGTH) tail.shift();\n\n        // Paint the tail\n        if (tail.length > 3) {\n            context.beginPath();\n            context.moveTo(tail[0].x, tail[0].y);\n\n            for (var i = 2; i < tail.length - 2; i++) {\n                const p1 = tail[i];\n                const p2 = tail[i + 1];\n\n                context.quadraticCurveTo(p1.x, p1.y, (p1.x + p2.x) / 2, (p1.y + p2.y) / 2);\n            }\n\n            context.quadraticCurveTo(tail[i].x, tail[i].y, tail[i + 1].x, tail[i + 1].y);\n\n            context.lineWidth = RADIUS;\n            context.lineCap = 'round';\n            context.strokeStyle = '#fff';\n            context.stroke();\n        }\n\n        // Animate the head towards target x/y\n        head.x += (head.tx - head.x) * 0.2;\n        head.y += (head.ty - head.y) * 0.2;\n\n        head.vx *= 0.8;\n        head.x += head.vx;\n\n        context.beginPath();\n        context.arc(head.x, head.y, RADIUS, 0, Math.PI * 2);\n        context.fillStyle = '#6a6376';\n        context.fill();\n    }\n}\n\nfunction focus(element) {\n    const previousFocus = currentFocus;\n\n    if (element) currentFocus = element;\n\n    if (!currentFocus) return;\n\n    head.tx = currentFocus.offsetLeft - 12 - RADIUS;\n    head.ty = currentFocus.offsetTop + currentFocus.offsetHeight / 2;\n\n    if (typeof head.x !== 'number') {\n        head.x = head.tx;\n        head.y = head.ty;\n    }\n\n    if (currentFocus !== previousFocus) {\n        head.vx = -8 - Math.abs(head.tx - head.x) / 5;\n    }\n}\n\nresize();\nredraw();\n\nwindow.addEventListener('resize', () => {\n    requestAnimationFrame(() => {\n        resize();\n        focus();\n        paint();\n    });\n});\n\nwindow.addEventListener('scroll', () => {\n    requestAnimationFrame(() => {\n        focus();\n        paint();\n    });\n});\n\n// document.querySelectorAll('input')[0].focus();"]}